<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Add Expense</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>Group Expense Manager</h1>
</header>

<nav>
  <a href="index.html">Create Group</a>
  <a href="add_expense.html">Add Expense</a>
  <a href="balance.html">Balances</a>
</nav>

<main>
  <section class="section">
    <h2>Add Expense</h2>
    <label for="expense-payer">Payer</label>
    <select id="expense-payer"></select>

    <label for="expense-amount">Amount (â‚¹)</label>
    <input type="number" id="expense-amount" min="0" step="0.01">

    <label for="expense-category">Category</label>
    <select id="expense-category">
      <option>Food</option>
      <option>Rent</option>
      <option>Travel</option>
      <option>Utilities</option>
      <option>Others</option>
    </select>

    <button id="add-expense-btn">Add Expense</button>
    <p class="error" id="expense-error"></p>
  </section>
</main>

<script>
const group = JSON.parse(localStorage.getItem("group"));
if (!group) {
  alert("Please create a group first!");
  window.location.href = "index.html";
}

const expensePayerSelect = document.getElementById("expense-payer");
group.members.forEach(m => {
  const option = document.createElement("option");
  option.value = m;
  option.textContent = m;
  expensePayerSelect.appendChild(option);
});

const expenseAmountInput = document.getElementById("expense-amount");
const expenseCategorySelect = document.getElementById("expense-category");
const addExpenseBtn = document.getElementById("add-expense-btn");
const expenseError = document.getElementById("expense-error");

addExpenseBtn.addEventListener("click", () => {
  expenseError.textContent = "";
  const payer = expensePayerSelect.value;
  const amount = parseFloat(expenseAmountInput.value);
  const category = expenseCategorySelect.value;

  if (!payer) { expenseError.textContent = "Select a payer."; return; }
  if (isNaN(amount) || amount <= 0) { expenseError.textContent = "Enter a valid amount."; return; }

  const expenses = JSON.parse(localStorage.getItem("expenses") || "[]");
  expenses.push({ payer, amount, category, date: new Date().toLocaleDateString() });
  localStorage.setItem("expenses", JSON.stringify(expenses));

  expenseAmountInput.value = "";
  alert("Expense added!");
});
</script>

</body>
</html>
